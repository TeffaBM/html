<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Programaci√≥n Lineal Editable</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #007BFF; /* Fondo azul corregido */
      color: white;
      margin: 0;
      padding: 20px;
    }

    /* El resto del estilo sigue igual... */
  </style>
</head>
<body>
  <!-- ... Todo tu HTML intacto (tablas, inputs, botones, etc) ... -->

  <script>
    // ‚úÖ CORRECCI√ìN: Interpolaci√≥n con backticks en lugar de string mal formado
    function calculateCurrent() {
      const x = parseFloat(document.getElementById('var-x').value) || 0;
      const y = parseFloat(document.getElementById('var-y').value) || 0;
      const coefX = parseFloat(document.getElementById('coef-x').value) || 0;
      const coefY = parseFloat(document.getElementById('coef-y').value) || 0;

      document.getElementById('excel-x').textContent = x;
      document.getElementById('excel-y').textContent = y;

      const objetivo = coefX * x + coefY * y;
      document.getElementById('excel-objetivo').textContent = objetivo.toFixed(2);

      let feasible = true;
      let violatedConstraints = [];

      constraints.forEach(constraint => {
        const value = constraint.coefX * x + constraint.coefY * y;
        const element = document.getElementById(`excel-rest${constraint.id}`); // <-- CORREGIDO
        if (element) {
          element.textContent = value.toFixed(2);
        }

        let satisfied = false;
        switch (constraint.operador) {
          case '<=':
            satisfied = value <= constraint.limite + 0.001;
            break;
          case '>=':
            satisfied = value >= constraint.limite - 0.001;
            break;
          case '=':
            satisfied = Math.abs(value - constraint.limite) < 0.001;
            break;
        }

        if (!satisfied) {
          feasible = false;
          violatedConstraints.push(`Restricci√≥n ${constraints.indexOf(constraint) + 1}`); // <-- CORREGIDO
        }
      });

      if (x < -0.001 || y < -0.001) {
        feasible = false;
        violatedConstraints.push('No negatividad');
      }

      const tipoObjetivo = document.getElementById('objetivo-tipo').value;
      const result = document.getElementById('result');
      result.innerHTML = `
        <h3>üìä Resultado Actual:</h3>
        <p><strong>X:</strong> ${x}</p>
        <p><strong>Y:</strong> ${y}</p>
        <p><strong>Funci√≥n Objetivo:</strong> ${objetivo.toFixed(2)} (${tipoObjetivo === 'max' ? 'Maximizar' : 'Minimizar'})</p>
        <p><strong>Estado:</strong> <span style="color: ${feasible ? '#4CAF50' : '#f44336'}; font-weight: bold;">
          ${feasible ? '‚úÖ FACTIBLE' : '‚ùå NO FACTIBLE'}
        </span></p>
        ${!feasible ? `<p><strong>Restricciones violadas:</strong> ${violatedConstraints.join(', ')}</p>` : ''}
      `;

      updateExcelSteps();
      drawGraph();
    }

    // ‚úÖ CORRECCI√ìN: uso correcto de backticks en updateExcelSteps
    function updateExcelSteps() {
      const coefX = parseFloat(document.getElementById('coef-x').value) || 0;
      const coefY = parseFloat(document.getElementById('coef-y').value) || 0;
      const objetivo = document.getElementById('objetivo-tipo').value;

      const stepsContainer = document.getElementById('excel-steps');
      let html = `
        <div class="step">
          <strong>Paso 1:</strong> En Excel, configura las variables de decisi√≥n:
          <br>‚Ä¢ B2: Variable X (valor inicial: cualquier n√∫mero)
          <br>‚Ä¢ C2: Variable Y (valor inicial: cualquier n√∫mero)
        </div>
        <div class="step">
          <strong>Paso 2:</strong> En D2, escribe la funci√≥n objetivo:
          <br><code>=${coefX}*B2+${coefY}*C2</code>
        </div>
      `;

      constraints.forEach((constraint, index) => {
        const row = index + 5;
        html += `
          <div class="step">
            <strong>Paso ${index + 3}:</strong> En B${row}, escribe la restricci√≥n ${index + 1}:
            <br><code>=${constraint.coefX}*B2+${constraint.coefY}*C2</code>
            <br>(Debe ser <strong>${constraint.operador} ${constraint.limite}</strong>)
          </div>
        `;
      });

      html += `
        <div class="step">
          <strong>Paso Final:</strong> Ve a <strong>Datos ‚Üí Solver</strong> y configura:
          <br>‚Ä¢ <strong>Objetivo:</strong> D2 (${objetivo === 'max' ? 'Maximizar' : 'Minimizar'})
          <br>‚Ä¢ <strong>Variables:</strong> B2:C2
          <br>‚Ä¢ <strong>Restricciones:</strong>
      `;

      constraints.forEach((constraint, index) => {
        const row = index + 5;
        html += `<br>&nbsp;&nbsp;- B${row} ${constraint.operador} ${constraint.limite}`; // <-- CORREGIDO
      });

      html += `
          <br>&nbsp;&nbsp;- B2 ‚â• 0
          <br>&nbsp;&nbsp;- C2 ‚â• 0
        </div>
      `;

      stepsContainer.innerHTML = html;
    }
  </script>
</body>
</html>
